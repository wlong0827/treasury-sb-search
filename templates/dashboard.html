<!DOCTYPE html>
<html lang="en" class="app">
<head>  
  <meta charset="utf-8" />
  <title>Treasury Small Business Search</title>
  <meta name="description" content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 

  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/app.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/bootstrap.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/animate.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/font-awesome.min.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/icon.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/font.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/bootstrap_calendar.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/js/calendar/bootstrap_calendar.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/css/dashboard.css') }}">

  <link rel="stylesheet" href="tabulator.css">
  <script type="text/javascript" src="tabulator.js"></script>

  <!--[if lt IE 9]>
    <script src="js/ie/html5shiv.js"></script>
    <script src="js/ie/respond.min.js"></script>
    <script src="js/ie/excanvas.js"></script>
  <![endif]-->
</head>
<body class="" >
  <section class="vbox">

    <section>
      <section class="hbox stretch">
      
        <!-- /.aside -->
        <section id="content">
          <section class="hbox stretch">
            <section>
              <section class="vbox">
                <section class="scrollable padder">              
                  <section class="row m-b-md">
                    <div class="col-sm-6">
                      <h1 class="m-b-xs text-black">Businesses Like Me</h1>
                      <large>Find business opportunities near <i class="fa fa-map-marker fa-lg text-primary"></i> <ins id="city"></ins>, <ins id="state"></ins></large>
                    </div>

                    <div class="col-sm-6" style="margin-top:10px">
                      <form class="navbar-form navbar-left input-s-lg m-t m-l-n-xs hidden-xs" action="/" role="search">
                        <div class="form-group">
                          <div class="input-group">
                            
                            <large class="text-muted text-u-c">Try a different Search</large>
                            <span class="input-group-btn">
                              <button type="submit" class="btn btn-lg bg-white b-white btn-icon"><i class="fa fa-search"></i></button>
                            </span>
                            
                          </div>
                        </div>
                      </form>
                    </div>
                  </section>

                  <div class="row">
                    <a href="https://spendingdata.us/#/award/44078">
                    <div class="col-sm-2 sample-business">
                      Clark Creative<br>
                      $154,000 from 4 contracts in FY 2016<br>
                      Top Awarding Agency: Department of Health and Human Services<br>
                      Number of employees: 15<br>
                    </div>
                    </a>
                    <a href="https://spendingdata.us/#/award/44078">
                    <div class="col-sm-2 sample-business">                      
                      Rethink Design Studio<br>
$1,489,000 from 7 contracts in FY 2016<br>
Top Awarding Agency: Department of Homeland Security<br>
Number of employees: 67<br>
                    </div>
                    </a>
                    <a href="https://spendingdata.us/#/award/44078">
                    <div class="col-sm-2 sample-business">
                      Applegate Design<br>
$45,000 from 1 contract in FY 2016<br>
Top Awarding Agency: Department of Education<br>
Number of employees: 13<br><br>
                    </div>
                    </a>
                    <a href="https://spendingdata.us/#/award/44078">
                    <div class="col-sm-2 sample-business">
                      Focus Lab, LLC<br>
$732,000 from 5 contracts in FY 2016<br>
Top Awarding Agency: Department of Health and Human Services<br>
Number of employees: 20<br>
                    </div>
                    </a>
                  </div>

                  

                  <div class="row">
                    <div class="col-sm-6">
                      <div class="panel b-a">
                        <div class="row m-n">
                          <div class="col-md-6 b-b b-r">
                            <a href="#" class="block padder-v hover">
                              <span class="i-s i-s-2x pull-left m-r-sm">
                                <i class="i i-hexagon2 i-s-base text-danger hover-rotate"></i>
                                <i class="i i-plus2 i-1x text-white"></i>
                              </span>
                              <span class="clear">
                                <span class="h3 block m-t-xs text-danger"><strong id="businesses"></strong></span>
                                <small class="text-muted text-u-c">businesses like you</small>
                              </span>
                            </a>
                          </div>
                          <div class="col-md-6 b-b">
                            <a href="#" class="block padder-v hover">
                              <span class="i-s i-s-2x pull-left m-r-sm">
                                <i class="i i-hexagon2 i-s-base text-success-lt hover-rotate"></i>
                                <i class="i i-users2 i-sm text-white"></i>
                              </span>
                              <span class="clear">
                                <span class="h3 block m-t-xs text-success">75%</span>
                                <small class="text-muted text-u-c">Increase in Contracts</small>
                              </span>
                            </a>
                          </div>
                          <div class="col-md-6 b-b b-r">
                            <a href="#" class="block padder-v hover">
                              <span class="i-s i-s-2x pull-left m-r-sm">
                                <i class="i i-hexagon2 i-s-base text-info hover-rotate"></i>
                                <i class="i i-location i-sm text-white"></i>
                              </span>
                              <span class="clear">
                                <span class="h3 block m-t-xs text-info">20 <span class="text-sm">mile</span></span>
                                <small class="text-muted text-u-c">Search Range</small>
                              </span>
                            </a>
                          </div>
                          <div class="col-md-6 b-b">
                            <a href="#" class="block padder-v hover">
                              <span class="i-s i-s-2x pull-left m-r-sm">
                                <i class="i i-hexagon2 i-s-base text-primary hover-rotate"></i>
                                <i class="i i-alarm i-sm text-white"></i>
                              </span>
                              <span class="clear">
                                <span class="h3 block m-t-xs text-primary">8 years</span>
                                <small class="text-muted text-u-c">Length of historical data</small>
                              </span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>


                    <div class="col-sm-3 hide">
                      <section class="panel b-a">
                        <header class="panel-heading b-b b-light">
                          <ul class="nav nav-pills pull-right">
                            <li>
                              <a href="ajax.pie.html" class="text-muted" data-bjax data-target="#b-c">
                                <i class="i i-cycle"></i>
                              </a>
                            </li>
                            <li>
                              <a href="#" class="panel-toggle text-muted">
                                <i class="i i-plus text-active"></i>
                                <i class="i i-minus text"></i>
                              </a>
                            </li>
                          </ul>
                          Connection
                        </header>
                        <div class="panel-body text-center bg-light lter" id="b-c">
                          <div class="easypiechart inline m-b m-t" data-percent="60" data-line-width="4" data-bar-Color="#23aa8c" data-track-Color="#c5d1da" data-color="#2a3844" data-scale-Color="false" data-size="120" data-line-cap='butt' data-animate="2000">
                            <div>
                              <span class="h2 m-l-sm step"></span>%
                              <div class="text text-xs">completed</div>
                            </div>
                          </div>
                        </div>
                      </section>                      
                    </div>
                  </div>           
                  <div class="row bg-light dk m-b">
                    <div class="col-md-6 dker">
                      <section>
                        <header class="font-bold padder-v">
                          <div class="pull-right">
                            <div class="btn-group">
                              <button data-toggle="dropdown" class="btn btn-sm btn-rounded btn-default dropdown-toggle">
                                <span class="dropdown-label">Week</span> 
                                <span class="caret"></span>
                              </button>
                              <ul class="dropdown-menu dropdown-select">
                                  <li><a href="#"><input type="radio" name="b">Month</a></li>
                                  <li><a href="#"><input type="radio" name="b">Week</a></li>
                                  <li><a href="#"><input type="radio" name="b">Day</a></li>
                              </ul>
                            </div>
                          </div>
                          Historical Statistics
                        </header>
                        <div class="panel-body">
                          <div id="flot-sp1ine" style="height:210px"></div>
                        </div>
                        <div class="row text-center no-gutter">
                          <div class="col-xs-3">
                            <span class="h4 font-bold m-t block"><p id="contracts"></p></span>
                            <small class="text-muted m-b block">Contracts</small>
                          </div>
                          <div class="col-xs-3">
                            <span class="h4 font-bold m-t block"><p id="businesses_2"></p></span>
                            <small class="text-muted m-b block">Companies</small>
                          </div>
                          <div class="col-xs-3">
                            <span class="h4 font-bold m-t block"><p id="total"></p></span>
                            <small class="text-muted m-b block">Total Contracts Value</small>
                          </div>
                          <div class="col-xs-3">
                            <span class="h4 font-bold m-t block"><p id="agencies"></p></span>
                            <small class="text-muted m-b block">Agencies</small>                        
                          </div>
                        </div>
                      </section>
                    </div>
                    <div class="col-md-6">
                      <section>
                        <header class="font-bold padder-v">
                          <div class="btn-group pull-right">
                            <button data-toggle="dropdown" class="btn btn-sm btn-rounded btn-default dropdown-toggle">
                              <span class="dropdown-label">Last Year</span> 
                              <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu dropdown-select">
                                <li><a href="#"><input type="radio" name="a">Last 2 Years</a></li>
                                <li><a href="#"><input type="radio" name="a">Last 3 Years</a></li>
                                <li><a href="#"><input type="radio" name="a">Last 4 Years</a></li>
                                <li><a href="#"><input type="radio" name="a">All Time</a></li>
                            </ul>
                          </div>
                          Spending Breakdown
                        </header>
                        <div class="panel-body flot-legend">
                          <div id="flot-pie-donut"  style="height:240px"></div>
                        </div>
                      </section>
                    </div>
                  </div>



                  <div class="row">
                    <center><h4>Recent Contracts</h4></center>

                    <script> 
                          var contracts = {{ data | tojson }}; 
                          // document.getElementById("print").innerHTML = contracts
                          var obj = JSON.parse(contracts);
                          var size = Object.keys(obj).length;

                          if (size > 0) {
                            var columnCount = obj[0].length;
                            var city = obj[0]['city']
                            var state = obj[0]['state']
                            var unique_businesses = []
                            var num_businesses = 0
                            var unique_agencies = []
                            var num_agencies = 0

                            for (var i = 0; i < size; i++) {
                              var name = obj[i.toString()]['vendorname'] 
                              if (unique_businesses.indexOf(name) == -1) {
                                num_businesses += 1
                                unique_businesses.push(name)
                              }

                              var agency = obj[i.toString()]['fundingrequestingagencyid'] 
                              if (unique_agencies.indexOf(name) == -1) {
                                num_agencies += 1
                                unique_agencies.push(name)
                              }
                            }

                          }       
                          else {
                            var columnCount = 1;
                            var city = "N/A"
                            var state = "N/A"
                            var num_businesses = 0
                            var num_agencies = 0
                          }                   
                          var total = 0
                          var num_contracts = 0

                          document.getElementById("city").innerHTML = city
                          document.getElementById("state").innerHTML = state
                          document.getElementById("businesses").innerHTML = num_businesses
                          document.getElementById("businesses_2").innerHTML = num_businesses
                          document.getElementById("agencies").innerHTML = num_agencies

                          var myTable = "<table class='table'><thead><tr><th width='100'>CONTRACT ID</th><th>COMPANY</th><th>DESCRIPTION</th><th width='90'>DATE</th><th width='90'>CONTRACT VALUE</th></tr></thead><tbody>";

                          for (var i = 0; i < size; i++) {
                              myTable += "<tr><td>" + obj[i.toString()]['unique_transaction_id'] + "</td><td>" + obj[i.toString()]['vendorname'] + "</td><td>" + obj[i.toString()]['descriptionofcontractrequirement'] +" </td><td>" + obj[i.toString()]['effectivedate'] + "</td><td> $" + obj[i.toString()]['dollarsobligated'] + "</td></tr>";

                              total += parseInt(obj[i.toString()]['dollarsobligated']);
                              num_contracts += 1
                          }
                          
                          if (size == 0) {
                            myTable += "<tr><td>N/A</td><td>No Results found for this search</td><td>N/A</td><td>N/A</td></tr>"
                          }

                          myTable += "<tr><td colspan='3' class='text-right no-border'><strong>Total</strong></td><td><strong>$" + total + "</strong></td></tr></tbody></table>"

                          document.write( myTable);
                          document.getElementById("total").innerHTML = "$" + total.toString()
                          document.getElementById("contracts").innerHTML = num_contracts.toString()
                          
                      </script>

                    <div class="line"></div>
                  </div>


                </section>
              </section>
            </section>
            
          </section>
          <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen,open" data-target="#nav,html"></a>
        </section>
      </section>
    </section>
  </section>

  <!-- <script src="js/jquery.min.js"></script> -->
  <script src="{{ url_for('static',filename='styles/js/jquery.min.js') }}"></script>
  <!-- Bootstrap -->
  <!-- <script src="js/bootstrap.js"></script> -->
  <script src="{{ url_for('static',filename='styles/js/bootstrap.js') }}"></script>
  <!-- App -->
  <script src="{{ url_for('static',filename='styles/js/app.js') }}"></script>

  <!-- <script src="js/app.js"></script>   -->
  <script src="{{ url_for('static',filename='styles/js/charts/easypiechart/jquery.easy-pie-chart.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/slimscroll/jquery.slimscroll.min.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/sparkline/jquery.sparkline.min.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/flot/jquery.flot.min.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/flot/jquery.flot.tooltip.min.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/flot/jquery.flot.spline.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/flot/jquery.flot.pie.min.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/charts/flot/demo.js') }}"></script>
  <script src="{{ url_for('static',filename='styles/js/calendar/demo.js') }}"></script>

</body>
</html>